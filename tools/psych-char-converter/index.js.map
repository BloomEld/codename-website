{"version":3,"file":"index.uncompressed.js","names":["input","document","getElementById","output","dropzone","fileInput","saveButton","fileNameDisplay","_saveFileBlob","blob","filename","link","createElement","href","URL","createObjectURL","download","body","appendChild","click","removeChild","preventDefaults","e","preventDefault","stopPropagation","addEventListener","outputValue","value","trim","lastFile","name","replace","Blob","type","alert","forEach","eventName","highlight","unhighlight","handleFiles","dataTransfer","files","highlightTimeout","classList","add","clearTimeout","setTimeout","remove","fileArray","Array","from","length","filter","file","startsWith","reader","FileReader","onload","target","result","xml","convert","readAsText","textContent","convertFolderButton","hex","num","size","s","toString","jsonInput","color","json","JSON","parse","xmlOutput","jsonPosition","position","jsonCameraPos","camera_position","jsonSingDuration","sing_duration","jsonScale","scale","jsonImage","image","slice","healthicon","healthbar_colors","flip_x","no_antialiasing","animations","a","anim","xOffset","offsets","yOffset","fps","loop","indices","numbers","separator","i","start","end","direction","push","join","formatNumberRange","promises","zip","JSZip","currDate","Date","defaults","date","getTime","getTimezoneOffset","convertFile","Promise","resolve","event","includes","all","then","generateAsync","content","saveBinaryFile"],"sources":["index.uncompressed.js"],"sourcesContent":["(function () {\nvar input = document.getElementById(\"input\");\nvar output = document.getElementById(\"output\");\n\nvar dropzone = document.getElementById(\"dropzone\");\nvar fileInput = document.getElementById(\"file\");\n\nvar saveButton = document.getElementById(\"save\");\n\nvar fileNameDisplay = document.getElementById('file-name');\n\nsaveButton.addEventListener(\"click\", function (e) {\n\te.preventDefault();\n\tvar outputValue = output.value.trim();\n\tif(outputValue == \"\") {\n\t\talert(\"Please paste your character data first!\");\n\t\treturn;\n\t}\n\tvar fileName = !lastFile ? \"character.xml\" : lastFile.name.replace(/\\.json$/, \".xml\");\n\tsaveFile(outputValue, fileName);\n});\n\nfunction saveFile(content, filename) {\n\tvar blob = new Blob([content], { type: \"text/plain;charset=utf-8\" });\n\t_saveFileBlob(blob, filename);\n}\n\nfunction saveBinaryFile(content, filename) {\n\tvar blob = new Blob([content], { type: \"application/octet-stream\" });\n\t_saveFileBlob(blob, filename);\n}\n\nfunction _saveFileBlob(blob, filename) {\n\tvar link = document.createElement(\"a\");\n\tlink.href = URL.createObjectURL(blob);\n\tlink.download = filename;\n\tdocument.body.appendChild(link);\n\tlink.click();\n\tdocument.body.removeChild(link);\n}\n\n['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {\n\tdropzone.addEventListener(eventName, preventDefaults, false);\n\tdocument.body.addEventListener(eventName, preventDefaults, false);\n});\n\n['dragenter', 'dragover'].forEach(eventName => {\n\tdropzone.addEventListener(eventName, highlight, false);\n});\n\n['dragleave', 'drop', \"dragend\"].forEach(eventName => {\n\tdropzone.addEventListener(eventName, unhighlight, false);\n});\n\ndropzone.addEventListener('drop', handleDrop, false);\n\nfunction preventDefaults(e) {\n\te.preventDefault();\n\te.stopPropagation();\n}\n\nvar highlightTimeout = null;\n\nfunction highlight() {\n\tdropzone.classList.add('highlight');\n\tclearTimeout(highlightTimeout);\n\thighlightTimeout = setTimeout(() => {\n\t\tunhighlight();\n\t}, 1000);\n}\n\nfunction unhighlight() {\n\tdropzone.classList.remove('highlight');\n}\n\nfunction handleDrop(e) {\n\tvar dt = e.dataTransfer;\n\tvar files = dt.files;\n\thandleFiles(files);\n}\n\nvar lastFile = null;\n\nfileInput.addEventListener('change', () => {\n\thandleFiles(fileInput.files);\n}, false);\n\nfunction handleFiles(files) {\n\tvar filename = \"No file chosen\";\n\tvar fileArray = Array.from(files);\n\tif(fileArray.length > 0) {\n\t\tvar files = fileArray.filter(file => file.type.startsWith(\"application/json\"));\n\t\tif(files.length > 0) {\n\t\t\tvar file = files[0];\n\t\t\tfilename = file.name;\n\t\t\tlastFile = file;\n\t\t\tvar reader = new FileReader();\n\t\t\treader.onload = function(e) {\n\t\t\t\tinput.value = e.target.result;\n\n\t\t\t\tvar xml = convert(input.value);\n\t\t\t\toutput.value = xml;\n\t\t\t};\n\t\t\treader.readAsText(file);\n\t\t}\n\t}\n\tfileNameDisplay.textContent = filename;\n}\n\n/*@__PURE__*/\nfunction formatNumberRange(numbers, separator = \",\") {\n\tif (numbers.length === 0) return \"\";\n\n\tvar result = [];\n\tvar i = 0;\n\n\twhile (i < numbers.length) {\n\t\tvar start = numbers[i];\n\t\tvar end = start;\n\t\tvar direction = 0; // 0: no sequence, 1: increasing, -1: decreasing\n\n\t\tif (i + 1 < numbers.length) { // detect direction of sequence\n\t\t\tif (numbers[i + 1] === end + 1) {\n\t\t\t\tdirection = 1;\n\t\t\t} else if (numbers[i + 1] === end - 1) {\n\t\t\t\tdirection = -1;\n\t\t\t}\n\t\t}\n\n\t\tif (direction !== 0) {\n\t\t\twhile (i + 1 < numbers.length && (numbers[i + 1] === end + direction)) {\n\t\t\t\tend = numbers[i + 1];\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\n\t\tif (start === end) { // no direction\n\t\t\tresult.push(start);\n\t\t} else if (start + direction === end) { // 1 step increment\n\t\t\tresult.push(start + \",\" + end);\n\t\t} else { // store as range\n\t\t\tresult.push(start + \"..\" + end);\n\t\t}\n\n\t\ti++;\n\t}\n\n\treturn result.join(separator);\n}\n\nvar convertFolderButton = document.getElementById(\"convert-folder\");\nconvertFolderButton.addEventListener(\"change\", () => {\n\tvar files = convertFolderButton.files;\n\tvar promises = [];\n\tvar zip = new JSZip();\n\n\tvar currDate = new Date();\n\t// sets the date to be fixed\n\tJSZip.defaults.date = new Date(currDate.getTime() - currDate.getTimezoneOffset() * 60000);\n\n\tvar convertFile = file => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tvar reader = new FileReader();\n\t\t\treader.onload = function(event) {\n\t\t\t\tzip.file(file.name.replace('.json', '.xml'), convert(event.target.result));\n\t\t\t\t//console.log('converted ' + file.name);\n\t\t\t\tresolve(\"wiz really likes furries\");\n\t\t\t};\n\t\t\treader.readAsText(file);\n\t\t});\n\t}\n\n\tfor(var file of files) {\n\t\tif (file.name.includes('.json')) {\n\t\t\tpromises.push(convertFile(file));\n\t\t}\n\t}\n\n\tPromise.all(promises).then(() => {\n\t\tzip.generateAsync({type:\"blob\"}).then(function(content) {\n\t\t\tsaveBinaryFile(content, \"characters.zip\");\n\t\t});\n\t});\n});\n\n/*@__PURE__*/\nfunction std_parseInt() {\n\tvar v = parseInt(x);\n\tif(isNaN(v)) {\n\t\treturn null;\n\t}\n\treturn v;\n}\n\nvar colorMapping = {\n\t\"TRANSPARENT\":0x00000000,\n\t\"WHITE\":0xFFFFFFFF,\n\t\"GRAY\":0xFF808080,\n\t\"BLACK\":0xFF000000,\n\t\"GREEN\":0xFF008000,\n\t\"LIME\":0xFF00FF00,\n\t\"YELLOW\":0xFFFFFF00,\n\t\"ORANGE\":0xFFFFA500,\n\t\"RED\":0xFFFF0000,\n\t\"PURPLE\":0xFF800080,\n\t\"BLUE\":0xFF0000FF,\n\t\"BROWN\":0xFF8B4513,\n\t\"PINK\":0xFFFFC0CB,\n\t\"MAGENTA\":0xFFFF00FF,\n\t\"CYAN\":0xFF00FFFF,\n}\n\nvar COLOR_REGEX = /^(0x|#)(([A-F0-9]{2}){3,4})$/i;\n/*@__PURE__*/\nfunction colorFromString(str) {\n\tvar result = null;\n\tif (COLOR_REGEX.test(str)) {\n\t\tvar match = COLOR_REGEX.exec(str);\n\t\tvar hexColor = \"0x\" + match[2];\n\t\tresult = std_parseInt(hexColor);\n\t\tif (hexColor.length == 8) {\n\t\t\tresult = result | 0xFF000000;\n\t\t}\n\t} else {\n\t\tif (colorMapping.hasOwnProperty(str.toUpperCase())) {\n\t\t\tresult = colorMapping[str.toUpperCase()];\n\t\t}\n\t}\n\n\treturn result;\n}\n\n/*@__PURE__*/\nfunction hex(num, size) {\n\tvar s = num.toString(16);\n\twhile (s.length < size) {\n\t\ts = \"0\" + s;\n\t}\n\treturn s;\n}\n\n/*@__PURE__*/\nfunction fromRGBArray(arr) {\n\tvar r = arr[0];\n\tvar g = arr[1];\n\tvar b = arr[2];\n\treturn 0xFF000000 | (r << 16) | (g << 8) | b;\n}\n\n/*@__PURE__*/\nfunction toWebColor(color, Alpha=true, Prefix=true) {\n\tvar color = color | 0;\n\tvar alpha = (color >> 24) & 0xFF;\n\tvar red = (color >> 16) & 0xFF;\n\tvar green = (color >> 8) & 0xFF;\n\tvar blue = color & 0xFF;\n\tvar prefix = Prefix ? \"#\" : \"\";\n\treturn prefix + (Alpha ? hex(alpha, 2) : \"\") + hex(red, 2) + hex(green, 2) + hex(blue, 2);\n}\n\n/*@__PURE__*/\nfunction convertRGBArrayToHex(color) {\n\treturn \"#\" + hex(color[0] & 0xFF, 2) + hex(color[1] & 0xFF, 2) + hex(color[2] & 0xFF, 2);\n}\n\n/*@__PURE__*/\nfunction roundDecimal(number, decimals) {\n\tvar pow = Math.pow(10, decimals);\n\treturn Math.round(number * pow) / pow;\n}\n\n\nfunction convert(jsonInput) {\n\tvar json = JSON.parse(jsonInput);\n\n\tvar xmlOutput = \"<!DOCTYPE codename-engine-character>\\n<!-- Made with WizardMantis's Character Converter on https://codename-engine.com/ -->\\n<character\";\n\n\tvar jsonPosition = json.position;\n\tvar jsonCameraPos = json.camera_position;\n\tvar jsonSingDuration = json.sing_duration;\n\tvar jsonScale = json.scale;\n\tvar jsonImage = json.image;\n\n\tif(jsonImage.startsWith(\"characters/\")) {\n\t\tjsonImage = jsonImage.slice(11);\n\t}\n\txmlOutput += ` sprite=\"${jsonImage}\"`;\n\txmlOutput += ` icon=\"${json.healthicon}\"`;\n\txmlOutput += ` color=\"${convertRGBArrayToHex(json.healthbar_colors)}\"`;\n\n\tif (jsonPosition[0] !== 0)\txmlOutput += ` x=\"${jsonPosition[0]}\"`;\n\tif (jsonPosition[1] !== 0)\txmlOutput += ` y=\"${jsonPosition[1]}\"`;\n\tif (json.flip_x)\t\t\txmlOutput += ` flipX=\"true\"`;\n\tif (json.no_antialiasing)\txmlOutput += ` antialiasing=\"false\"`;\n\tif (jsonCameraPos[0] !== 0)\txmlOutput += ` camx=\"${jsonCameraPos[0]}\"`;\n\tif (jsonCameraPos[1] !== 0)\txmlOutput += ` camy=\"${jsonCameraPos[1]}\"`;\n\tif (jsonSingDuration !== 4)\txmlOutput += ` holdTime=\"${jsonSingDuration}\"`;\n\tif (jsonScale !== 1)\t\txmlOutput += ` scale=\"${jsonScale}\"`;\n\n\txmlOutput += \">\\n\"\n\n\tjson.animations.forEach(function (a) {\n\t\txmlOutput += `\\t<anim name=\"${a.anim}\" anim=\"${a.name}\"`;\n\t\tvar xOffset = a.offsets[0] / jsonScale;//roundDecimal(a.offsets[0] / scale, 5);\n\t\tvar yOffset = a.offsets[1] / jsonScale;//roundDecimal(a.offsets[1] / scale, 5);\n\t\tvar needsOffset = xOffset !== 0 || yOffset !== 0;\n\t\tif (needsOffset)\t\t\txmlOutput += ` x=\"${xOffset}\" y=\"${yOffset}\"`;\n\t\tif (a.fps !== 24)\t\t\txmlOutput += ` fps=\"${a.fps}\"`;\n\t\tif (a.loop)\t\t\t\t\txmlOutput += ` loop=\"true\"`;\n\t\tif (a.indices.length !== 0)\txmlOutput += ` indices=\"${formatNumberRange(a.indices)}\"`;\n\t\txmlOutput += '/>\\n'\n\t});\n\n\txmlOutput += \"</character>\";\n\n\treturn xmlOutput;\n}\n})();"],"mappings":"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","ignoreList":[]}