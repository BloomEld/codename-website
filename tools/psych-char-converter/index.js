(()=>{var e=document.getElementById("input"),t=document.getElementById("output"),a=document.getElementById("dropzone"),n=document.getElementById("file"),r=document.getElementById("save"),i=document.getElementById("file-name");function o(e,t){var a=document.createElement("a");a.href=URL.createObjectURL(e),a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)}function l(e){e.preventDefault(),e.stopPropagation()}r.addEventListener("click",(e=>{e.preventDefault();var a,n=t.value.trim();""!==n?(a=m?m.name.replace(/\.json$/,".xml"):"character.xml",o(new Blob([n],{type:"text/plain;charset=utf-8"}),a)):alert("Please paste your character data first!")})),["dragenter","dragover","dragleave","drop"].forEach((e=>{a.addEventListener(e,l,!1),document.body.addEventListener(e,l,!1)})),["dragenter","dragover"].forEach((e=>{a.addEventListener(e,d,!1)})),["dragleave","drop","dragend"].forEach((e=>{a.addEventListener(e,c,!1)})),a.addEventListener("drop",(e=>{f(e.dataTransfer.files)}),!1);var s=null;function d(){a.classList.add("highlight"),clearTimeout(s),s=setTimeout((()=>{c()}),1e3)}function c(){a.classList.remove("highlight")}var m=null;function f(a){var n="No file chosen",r=Array.from(a);if(r.length>0&&(a=r.filter((e=>e.type.startsWith("application/json"))),a.length>0)){var o=a[0];n=o.name,m=o;var l=new FileReader;l.onload=a=>{e.value=a.target.result;var n=p(e.value);t.value=n},l.readAsText(o)}i.textContent=n}n.addEventListener("change",(()=>{f(n.files)}),!1);var h=document.getElementById("convert-folder");function u(e,t){for(var a=e.toString(16);a.length<t;)a="0"+a;return a}function p(e){var t,a=JSON.parse(e),n="<!DOCTYPE codename-engine-character>\n\x3c!-- Made with WizardMantis's Character Converter on https://codename-engine.com/ --\x3e\n<character",r=a.position,i=a.camera_position,o=a.sing_duration,l=a.scale,s=a.image;return s.startsWith("characters/")&&(s=s.slice(11)),n+=` sprite="${s}"`,n+=` icon="${a.healthicon}"`,n+=` color="${t=a.healthbar_colors,"#"+u(255&t[0],2)+u(255&t[1],2)+u(255&t[2],2)}"`,0!==r[0]&&(n+=` x="${r[0]}"`),0!==r[1]&&(n+=` y="${r[1]}"`),a.flip_x&&(n+=' flipX="true"'),a.no_antialiasing&&(n+=' antialiasing="false"'),0!==i[0]&&(n+=` camx="${i[0]}"`),0!==i[1]&&(n+=` camy="${i[1]}"`),4!==o&&(n+=` holdTime="${o}"`),1!==l&&(n+=` scale="${l}"`),n+=">\n",a.animations.forEach((e=>{n+=`\t<anim name="${e.anim}" anim="${e.name}"`;var t=e.offsets[0]/l,a=e.offsets[1]/l;(0!==t||0!==a)&&(n+=` x="${t}" y="${a}"`),24!==e.fps&&(n+=` fps="${e.fps}"`),e.loop&&(n+=' loop="true"'),0!==e.indices.length&&(n+=` indices="${((e,t=",")=>{if(0===e.length)return"";for(var a=[],n=0;n<e.length;){var r=e[n],i=r,o=0;if(n+1<e.length&&(e[n+1]===i+1?o=1:e[n+1]===i-1&&(o=-1)),0!==o)for(;n+1<e.length&&e[n+1]===i+o;)i=e[n+1],n++;r===i?a.push(r):r+o===i?a.push(r+","+i):a.push(r+".."+i),n++}return a.join(t)})(e.indices)}"`),n+="/>\n"})),n+="</character>"}h.addEventListener("change",(()=>{var e=h.files,t=[],a=new JSZip,n=new Date;JSZip.defaults.date=new Date(n.getTime()-6e4*n.getTimezoneOffset());var r=e=>new Promise((t=>{var n=new FileReader;n.onload=n=>{a.file(e.name.replace(/\.json$/,".xml"),p(n.target.result)),t("wiz really likes furries")},n.readAsText(e)}));for(var i of e)i.name.endsWith(".json")&&t.push(r(i));Promise.all(t).then((()=>{a.generateAsync({type:"blob"}).then((e=>{(e=>{o(new Blob([e],{type:"application/octet-stream"}),"characters.zip")})(e)}))}))}))})();
//# sourceMappingURL=index.js.map